<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Min Statistikk - Tippekonkurranse</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="style.css?v=20251123a">
    <link rel="stylesheet" href="unified-design.css?v=20251204">
</head>
<body>
    <div class="container">
        <!-- Header injected by header.js -->
        <div id="headerContainer"></div>

        <!-- Loading State -->
        <div id="loadingState" class="stats-loading">
            <div class="loading-spinner"></div>
            <p>Laster statistikk...</p>
        </div>

        <main id="mainContent" style="display: none;">
            <!-- Ranking Hero Section -->
            <section class="stats-hero">
                <div class="rank-card">
                    <div class="rank-position">
                        <span class="rank-hash">#</span>
                        <span class="rank-number" id="userRank">-</span>
                    </div>
                    <div class="rank-info">
                        <span class="rank-label">Din plassering</span>
                        <span class="rank-total" id="totalPlayers">av - spillere</span>
                    </div>
                </div>
                <div class="points-display">
                    <span class="points-value" id="totalPoints">0</span>
                    <span class="points-label">totale poeng</span>
                </div>
            </section>

            <!-- Hit Rate Stats -->
            <section class="stats-hitrates">
                <div class="hitrate-card">
                    <div class="hitrate-circle" id="outcomeCircle">
                        <svg viewBox="0 0 100 100">
                            <circle class="hitrate-bg" cx="50" cy="50" r="45"/>
                            <circle class="hitrate-progress outcome" cx="50" cy="50" r="45" id="outcomeProgress"/>
                        </svg>
                        <span class="hitrate-value" id="outcomeRate">0%</span>
                    </div>
                    <div class="hitrate-label">Utfall treffrate</div>
                    <div class="hitrate-detail" id="outcomeDetail">0 av 0 riktig utfall</div>
                </div>
                <div class="hitrate-card">
                    <div class="hitrate-circle" id="exactCircle">
                        <svg viewBox="0 0 100 100">
                            <circle class="hitrate-bg" cx="50" cy="50" r="45"/>
                            <circle class="hitrate-progress exact" cx="50" cy="50" r="45" id="exactProgress"/>
                        </svg>
                        <span class="hitrate-value" id="exactRate">0%</span>
                    </div>
                    <div class="hitrate-label">Eksakt treffrate</div>
                    <div class="hitrate-detail" id="exactDetail">0 av 0 riktig resultat</div>
                </div>
            </section>

            <!-- Comparison Section -->
            <section class="stats-comparison">
                <h3>Sammenligning med andre</h3>
                <div class="comparison-bars">
                    <div class="comparison-item">
                        <div class="comparison-label">
                            <span>Poeng per kamp (totalt)</span>
                            <span class="comparison-values">
                                <span class="your-value" id="avgPointsYou">0.0</span>
                                <span class="vs">vs</span>
                                <span class="avg-value" id="avgPointsAvg">0.0 snitt</span>
                            </span>
                        </div>
                        <div class="comparison-bar-container">
                            <div class="comparison-bar your-bar" id="avgPointsBar" style="width: 0%"></div>
                            <div class="comparison-bar avg-bar" id="avgPointsAvgBar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-label">
                            <span>Poeng per kamp (kun utfall)</span>
                            <span class="comparison-values">
                                <span class="your-value" id="avgOutcomePointsYou">0.0</span>
                                <span class="vs">vs</span>
                                <span class="avg-value" id="avgOutcomePointsAvg">0.0 snitt</span>
                            </span>
                        </div>
                        <div class="comparison-bar-container">
                            <div class="comparison-bar your-bar" id="avgOutcomePointsBar" style="width: 0%"></div>
                            <div class="comparison-bar avg-bar" id="avgOutcomePointsAvgBar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-label">
                            <span>Utfall treffrate</span>
                            <span class="comparison-values">
                                <span class="your-value" id="outcomeYou">0%</span>
                                <span class="vs">vs</span>
                                <span class="avg-value" id="outcomeAvg">0% snitt</span>
                            </span>
                        </div>
                        <div class="comparison-bar-container">
                            <div class="comparison-bar your-bar" id="outcomeBar" style="width: 0%"></div>
                            <div class="comparison-bar avg-bar" id="outcomeAvgBar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="comparison-item">
                        <div class="comparison-label">
                            <span>Eksakt treffrate</span>
                            <span class="comparison-values">
                                <span class="your-value" id="exactYou">0%</span>
                                <span class="vs">vs</span>
                                <span class="avg-value" id="exactAvg">0% snitt</span>
                            </span>
                        </div>
                        <div class="comparison-bar-container">
                            <div class="comparison-bar your-bar" id="exactBar" style="width: 0%"></div>
                            <div class="comparison-bar avg-bar" id="exactAvgBar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- League Stats -->
            <section class="stats-leagues">
                <h3>Statistikk per liga</h3>
                <div class="league-stats-list" id="leagueStatsList">
                    <div class="loading-message">Laster...</div>
                </div>
            </section>

            <!-- Match History -->
            <section class="stats-history">
                <h3>Siste kamper</h3>
                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="filterHistory('all')">Alle</button>
                    <button class="filter-btn" onclick="filterHistory('correct')">Eksakt</button>
                    <button class="filter-btn" onclick="filterHistory('direction')">Utfall</button>
                    <button class="filter-btn" onclick="filterHistory('wrong')">Feil</button>
                </div>
                <div id="matchHistoryList" class="match-history-list">
                    <div class="loading-message">Laster...</div>
                </div>
            </section>
        </main>

        <!-- Auth Required Message -->
        <div id="authRequired" class="auth-required" style="display: none;">
            <div class="auth-required-content">
                <h2>Logg inn for a se statistikk</h2>
                <p>Du ma vare innlogget for a se din personlige statistikk.</p>
                <button onclick="window.location.href='index.html'" class="btn-primary">
                    Ga til palogging
                </button>
            </div>
        </div>
    </div>

    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- App Scripts -->
    <script src="supabase-auth.js?v=20251222e"></script>
    <script src="api-config.js"></script>
    <script type="module">
        import { initHeader } from './header.js';
        initHeader('my-stats');
    </script>
    <script type="module" src="my-stats-supabase.js?v=20251123a"></script>
</body>
</html>
